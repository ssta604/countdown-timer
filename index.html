<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown Timer</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="favicon.ico" sizes="any">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Roboto+Mono:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="app.css">
</head>
<body>
    <div class="container">
        <h1 class="title">Something Big is Coming</h1>
        <p id="subtitle" class="subtitle"></p>
        <div id="countdown-container">
            <div class="tile">
                <div id="days" class="number mono-font">00</div>
                <div class="label">Days</div>
            </div>
            <div class="tile">
                <div id="hours" class="number mono-font">00</div>
                <div class="label">Hours</div>
            </div>
            <div class="tile">
                <div id="minutes" class="number mono-font">00</div>
                <div class="label">Minutes</div>
            </div>
            <div class="tile">
                <div id="seconds" class="number mono-font">00</div>
                <div class="label">Seconds</div>
            </div>
        </div>

        <div class="share-container">
            <button id="settings-button" class="action-button" title="Settings">
                <svg class="action-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37a1.724 1.724 0 002.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                <span class="sr-only">Settings</span>
            </button>
            <button id="share-button" class="action-button" title="Share Countdown">
                <svg class="action-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6.002l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.367a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path></svg>
                <span class="sr-only">Share countdown</span>
            </button>
        </div>
    </div>

    <div id="qr-popup" class="hidden">
        <div class="popup-content">
            <button id="close-popup">
                <svg class="share-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                <span class="sr-only">Close popup</span>
            </button>
            <h2 class="popup-title">Share Countdown</h2>
            <p class="popup-text">Scan with your phone's camera.</p>
            <div class="qr-wrapper">
                 <img src="https://api.qrserver.com/v1/create-qr-code/?size=160x160&data=https://ssta604.github.io/countdown-timer/&color=111827&bgcolor=FFFFFF&margin=1" alt="QR Code linking to the countdown page" onerror="this.onerror=null;this.src='https://via.placeholder.com/160';">
            </div>
        </div>
    </div>

    <div id="reload-prompt" class="hidden">
        <div class="popup-content">
            <h2 class="popup-title">New Version Available</h2>
            <p class="popup-text">A new version of this page is available. Please reload to get the latest updates.</p>
            <button id="reload-button">Reload</button>
        </div>
    </div>


    <script>
        

        // Popup logic
        const shareButton = document.getElementById('share-button');
        const closeButton = document.getElementById('close-popup');
        const qrPopup = document.getElementById('qr-popup');

        shareButton.addEventListener('click', () => {
            qrPopup.classList.remove('hidden');
        });

        closeButton.addEventListener('click', () => {
            qrPopup.classList.add('hidden');
        });

        // Close popup when clicking outside the modal content
        qrPopup.addEventListener('click', (event) => {
            if (event.target === qrPopup) {
                qrPopup.classList.add('hidden');
            }
        });

        if ('serviceWorker' in navigator) {
          let newWorker;
          navigator.serviceWorker.register('/countdown-timer/sw.js').then(reg => {
            reg.addEventListener('updatefound', () => {
              newWorker = reg.installing;
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  const reloadPrompt = document.getElementById('reload-prompt');
                  reloadPrompt.classList.remove('hidden');
                  const reloadButton = document.getElementById('reload-button');
                  reloadButton.addEventListener('click', () => {
                    newWorker.postMessage({ action: 'skipWaiting' });
                  });
                }
              });
            });
          });

          navigator.serviceWorker.addEventListener('controllerchange', () => {
            window.location.reload();
          });
        }
    </script>
    <div id="settings-modal" class="modal" style="display: none;">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Settings</h2>
        <label for="event-name">Event Name:</label>
        <input type="text" id="event-name" value="New Year">
        <label for="countdown-date">Countdown Date:</label>
        <input type="datetime-local" id="countdown-date">
        <label for="theme-select">Color Theme:</label>
        <select id="theme-select">
          <option value="dark">Dark</option>
          <option value="light">Light</option>
          <option value="blue">Blue</option>
          <option value="green">Green</option>
          <option value="red">Red</option>
          <option value="purple">Purple</option>
          <option value="aqua">Aqua</option>
          <option value="orange">Orange</option>
          <option value="pink">Pink</option>
          <option value="teal">Teal</option>
          <option value="brown">Brown</option>
          <option value="lime">Lime</option>
          <option value="indigo">Indigo</option>
        </select>
        <button id="save-settings">Save</button>
      </div>
    </div>
    <script src="settings.js"></script>
</body>
</html>

